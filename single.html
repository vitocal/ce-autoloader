<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CEAutoLoader - Single view-transition</title>

    <link rel="preload" href="/docs/styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript>
        <link rel="stylesheet" href="/docs/styles.css">
    </noscript>

    <script type="importmap">
    {
        "imports": {
            "lit": "https://esm.sh/lit@3.3.1?bundle",
            "@nordhealth/components/": "https://esm.sh/@nordhealth/components/"
        }
    }
    </script>

    <style>
        body {
            max-width: 90%;
            margin: 0 auto;
        }
    </style>

    <script type="module">
        import Button from '@nordhealth/components/lib/Button.js?bundle';
    </script>
</head>

<body class="container n-reset">
    <p>
        Playground for view transitions
    </p>

    <nord-button onclick="start(event)" variant="primary">Start -></nord-button>

    <p>Lorem ipsum dolor, sit amet consectetur adipisicing elit. Fugit consequatur dignissimos accusantium ipsum optio
        placeat iusto et! Maiores optio rerum voluptate, culpa doloribus, similique, placeat tenetur maxime obcaecati
        recusandae praesentium.</p>
    <p>Lorem ipsum dolor, sit amet consectetur adipisicing elit. Fugit consequatur dignissimos accusantium ipsum optio
        placeat iusto et! Maiores optio rerum voluptate, culpa doloribus, similique, placeat tenetur maxime obcaecati
        recusandae praesentium.</p>
    <p>Lorem ipsum dolor, sit amet consectetur adipisicing elit. Fugit consequatur dignissimos accusantium ipsum optio
        placeat iusto et! Maiores optio rerum voluptate, culpa doloribus, similique, placeat tenetur maxime obcaecati
        recusandae praesentium.</p>
    <p>Lorem ipsum dolor, sit amet consectetur adipisicing elit. Fugit consequatur dignissimos accusantium ipsum optio
        placeat iusto et! Maiores optio rerum voluptate, culpa doloribus, similique, placeat tenetur maxime obcaecati
        recusandae praesentium.</p>
    <p>Lorem ipsum dolor, sit amet consectetur adipisicing elit. Fugit consequatur dignissimos accusantium ipsum optio
        placeat iusto et! Maiores optio rerum voluptate, culpa doloribus, similique, placeat tenetur maxime obcaecati
        recusandae praesentium.</p>
    <p>Lorem ipsum dolor, sit amet consectetur adipisicing elit. Fugit consequatur dignissimos accusantium ipsum optio
        placeat iusto et! Maiores optio rerum voluptate, culpa doloribus, similique, placeat tenetur maxime obcaecati
        recusandae praesentium.</p>
    <p>Lorem ipsum dolor, sit amet consectetur adipisicing elit. Fugit consequatur dignissimos accusantium ipsum optio
        placeat iusto et! Maiores optio rerum voluptate, culpa doloribus, similique, placeat tenetur maxime obcaecati
        recusandae praesentium.</p>
    <p>Lorem ipsum dolor, sit amet consectetur adipisicing elit. Fugit consequatur dignissimos accusantium ipsum optio
        placeat iusto et! Maiores optio rerum voluptate, culpa doloribus, similique, placeat tenetur maxime obcaecati
        recusandae praesentium.</p>
    <p>Lorem ipsum dolor, sit amet consectetur adipisicing elit. Fugit consequatur dignissimos accusantium ipsum optio
        placeat iusto et! Maiores optio rerum voluptate, culpa doloribus, similique, placeat tenetur maxime obcaecati
        recusandae praesentium.</p>
    <p>Lorem ipsum dolor, sit amet consectetur adipisicing elit. Fugit consequatur dignissimos accusantium ipsum optio
        placeat iusto et! Maiores optio rerum voluptate, culpa doloribus, similique, placeat tenetur maxime obcaecati
        recusandae praesentium.</p>
    <p>Lorem ipsum dolor, sit amet consectetur adipisicing elit. Fugit consequatur dignissimos accusantium ipsum optio
        placeat iusto et! Maiores optio rerum voluptate, culpa doloribus, similique, placeat tenetur maxime obcaecati
        recusandae praesentium.</p>
    <p>Lorem ipsum dolor, sit amet consectetur adipisicing elit. Fugit consequatur dignissimos accusantium ipsum optio
        placeat iusto et! Maiores optio rerum voluptate, culpa doloribus, similique, placeat tenetur maxime obcaecati
        recusandae praesentium.</p>
    <p>Lorem ipsum dolor, sit amet consectetur adipisicing elit. Fugit consequatur dignissimos accusantium ipsum optio
        placeat iusto et! Maiores optio rerum voluptate, culpa doloribus, similique, placeat tenetur maxime obcaecati
        recusandae praesentium.</p>
    <p>Lorem ipsum dolor, sit amet consectetur adipisicing elit. Fugit consequatur dignissimos accusantium ipsum optio
        placeat iusto et! Maiores optio rerum voluptate, culpa doloribus, similique, placeat tenetur maxime obcaecati
        recusandae praesentium.</p>
    <p>Lorem ipsum dolor, sit amet consectetur adipisicing elit. Fugit consequatur dignissimos accusantium ipsum optio
        placeat iusto et! Maiores optio rerum voluptate, culpa doloribus, similique, placeat tenetur maxime obcaecati
        recusandae praesentium.</p>
    <p>Lorem ipsum dolor, sit amet consectetur adipisicing elit. Fugit consequatur dignissimos accusantium ipsum optio
        placeat iusto et! Maiores optio rerum voluptate, culpa doloribus, similique, placeat tenetur maxime obcaecati
        recusandae praesentium.</p>
    <p>Lorem ipsum dolor, sit amet consectetur adipisicing elit. Fugit consequatur dignissimos accusantium ipsum optio
        placeat iusto et! Maiores optio rerum voluptate, culpa doloribus, similique, placeat tenetur maxime obcaecati
        recusandae praesentium.</p>

    <nord-banner variant="success">
        <span>Your order has been shipped and will arrive on May 27th. <a href="#">Track order.</a></span>
    </nord-banner>

    <nord-calendar>

    </nord-calendar>


    <!--
    How to disable css temporarly
     document.querySelector('link[href="a.css"]').disabled = true
    -->


    <script type="module">
        import CERegistry from './src/index.js';

        const capitalize = (str) =>
            str.split('-').map((word) => word.charAt(0).toUpperCase() + word.slice(1)).join('');

        window.addEventListener('load', async () => {
            console.log("load");
            performance.mark('pageload:start');
            performance.mark('pageload:end');
            performance.measure('pageload', 'pageload:start', 'pageload:end')
        })

        const catalog = {

            /**
             * Nord Health design system
             */
            "nord-*": async (full_name) => {
                const [, namespace, name] = full_name.match(/^([a-z]+)-(.*)/);
                const module = await import(/* @vite-ignore */ `@nordhealth/components/lib/${capitalize(name)}.js?bundle`);
                if (!customElements.get(full_name)) {
                    customElements.define(full_name, module.default);
                }
                return module
            },
            "three-cube": "/src/components/three-cube.js",
        };

        class MyCustomRegistry extends CERegistry {

            async beforeLoad({ name, el, asset }, next) {
                // add loading/transition-class to all components
                el.setAttribute('loading', 'true');

                await next({ name, el, asset });
            }

            async afterLoad({ name, el, asset }, next) {
                el.removeAttribute('loading');
                el.setAttribute('ready', "");
                // el.style.viewTransitionName = 'match-element';
                // el.style.viewTransitionClass = el.tagName.toLowerCase();

                this.batches.push(async () => {
                    return await next({ name, asset });
                });
            }

        }

        globalThis.registry = new MyCustomRegistry({
            catalog,
            root: document.body,
            live: true,
            fallback: false,
            defaultDirective: "lazy",
        });


        // performance.mark('discover:start');
        // await registry.discover();
        // performance.mark('discover:end');
        // performance.measure('discover', 'discover:start', 'discover:end')

    </script>
    <script type="module">
        async function start(ev) {
            ev.target.setAttribute('loading', true);
            await registry.discover();
            ev.target.removeAttribute('loading');
        }
        window.start = start;
    </script>
</body>

</html>